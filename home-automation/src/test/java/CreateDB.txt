--"jdbc:postgresql://localhost:5432/HOME_AUTOMATION", "postgres", "Welcome123#"

CREATE SEQUENCE USER_ID_SEQ START 101;
CREATE SEQUENCE MASTER_ID_SEQ START 101;
CREATE SEQUENCE SLAVE_ID_SEQ START 101;
CREATE SEQUENCE SENSOR_ID_SEQ START 101;
CREATE SEQUENCE SENSOR_HISTORY_SEQ START 100;
CREATE SEQUENCE SENSOR_STATUS_SEQ START 100;
CREATE SEQUENCE MASTER_HISTORY_SEQ START 100;
CREATE SEQUENCE MASTER_MESSAGE_SEQ START 100;
CREATE SEQUENCE FD_DETAILS_SEQ START 100;
CREATE SEQUENCE EXP_DETAILS_SEQ START 100;
CREATE SEQUENCE EXP_HIS_DETAILS_SEQ START 1;

select nextval('USER_ID_SEQ');

CREATE TABLE UserMaster (
   UserID INTEGER DEFAULT nextval('USER_ID_SEQ'),
   UserName VARCHAR(40) NOT NULL,
   UserKey VARCHAR(50) NOT NULL,
   UserStatus VARCHAR(1) DEFAULT 'Y',
   UserType VARCHAR(1) DEFAULT 'C',
   LastLoggedIn TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
   Address1 VARCHAR(100) NULL,
   Address2 VARCHAR(100) NULL,
   City VARCHAR(50) NULL,
   State VARCHAR(50) NULL,
   Country VARCHAR(50) NULL,
   PinCode VARCHAR(10) NULL,
   displayName VARCHAR(100) NULL,
   PRIMARY KEY(UserID)
);
CREATE TABLE MasterUnitController (
   MasterUnitID INTEGER DEFAULT nextval('Master_ID_SEQ'),
   MasterUnitName VARCHAR(50) NOT NULL,
   MasterUnitMacID VARCHAR(50) NOT NULL,
   MasterUnitIPADDR VARCHAR(20) NOT NULL,
   MasterUnitSoftwareVersion VARCHAR(50) NOT NULL,
   MasterUnitLicense VARCHAR(50) NOT NULL,
   MasterUnitStatus VARCHAR(1) DEFAULT 'N',
   UserID INTEGER NOT NULL,
   MasterUnitLastLoggedIn TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY(MasterUnitID),
   FOREIGN KEY (UserID) REFERENCES UserMaster(UserID)
);
CREATE TABLE SlaveUnit (
   SlaveUnitID INTEGER DEFAULT nextval('SLAVE_ID_SEQ'),
   MasterUnitID INTEGER NOT NULL,
   SlaveUnitName VARCHAR(50) NOT NULL,
   SlaveUnitType VARCHAR(50) NOT NULL,
   PRIMARY KEY(SlaveUnitID),
   FOREIGN KEY (MasterUnitID) REFERENCES MasterUnitController(MasterUnitID)
);
CREATE TABLE SensorUnit (
   SensorID INTEGER DEFAULT nextval('SENSOR_ID_SEQ'),
   SlaveUnitID INTEGER NOT NULL,
   SensorName VARCHAR(50) NOT NULL,
   SensorValue VARCHAR(3) NULL,
   SensorType VARCHAR(10) NULL,
   SensorLastChange TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY (SensorID),
   FOREIGN KEY (SlaveUnitID) REFERENCES SlaveUnit(SlaveUnitID)
);
CREATE TABLE SensorStatus (
   SensorStatusID INTEGER DEFAULT nextval('SENSOR_STATUS_SEQ'),
   SensorID INTEGER NOT NULL,
   SensorOnTime TIMESTAMP,
   SensorOffTime TIMESTAMP,
   SensorDuration INTEGER,
   PRIMARY KEY (SensorStatusID),
   FOREIGN KEY (SensorID) REFERENCES SensorUnit(SensorID)
);
CREATE TABLE SensorHistory (
   SensorHistoryID INTEGER DEFAULT nextval('SENSOR_HISTORY_SEQ'),
   SensorID INTEGER NOT NULL,
   SensorOldValue VARCHAR(3),
   SensorNewValue VARCHAR(3),
   ModifiedDate TIMESTAMP,
   ModifiedByClientID VARCHAR(50) NULL,
   PRIMARY KEY (SensorHistoryID),
   FOREIGN KEY (SensorID) REFERENCES SensorUnit(SensorID)
);
CREATE TABLE MasterUnitHistory (
  MasterHistoryID INTEGER DEFAULT nextval('MASTER_HISTORY_SEQ'),
  MasterUnitID INTEGER NOT NULL,
  CameOnline TIMESTAMP,
  WentOffline TIMESTAMP,
  Duration INTEGER,
  PRIMARY KEY (MasterHistoryID),
  FOREIGN KEY (MasterUnitID) REFERENCES MasterUnitController(MasterUnitID)
);
CREATE TABLE MasterUnitMessage (
  MasterMessageID INTEGER DEFAULT nextval('MASTER_MESSAGE_SEQ'),
  MasterUnitID INTEGER NOT NULL,
  Message VARCHAR(200) NULL,
  MessageOn TIMESTAMP,
  PRIMARY KEY (MasterMessageID),
  FOREIGN KEY (MasterUnitID) REFERENCES MasterUnitController(MasterUnitID)
);

CREATE TABLE FIN_FD_MASTER (
  FD_ID INTEGER DEFAULT NEXTVAL('FD_DETAILS_SEQ'),
  FD_NUMBER VARCHAR(50) NOT NULL,
  FD_DATE TIMESTAMP,
  FD_AMOUNT INTEGER NOT NULL,
  FD_NAME VARCHAR(60) NOT NULL,
  FD_MATURITY_AMT INTEGER NOT NULL,
  FD_MATURITY_DATE TIMESTAMP NOT NULL,
  PRIMARY KEY (FD_ID),
  FOREIGN KEY (FD_NAME) REFERENCES UserMaster(UserID)
);

CREATE TABLE EXPENCE_TYPE (
  EXP_ID INTEGER DEFAULT NEXTVAL('EXP_DETAILS_SEQ'),
  EXP_NAME VARCHAR(50) NOT NULL,
  EXP_STATUS VARCHAR(1) DEFAULT 'Y',
  PRIMARY KEY (EXP_ID)
);

CREATE TABLE EXPENCE_HISTORY (
  EXP_HIS_ID INTEGER DEFAULT NEXTVAL('EXP_HIS_DETAILS_SEQ'),
  EXP_ID INTEGER NOT NULL,
  EXP_DATE TIMESTAMP NOT NULL,
  EXP_AMT VARCHAR(5) NOT NULL,
  UserID INTEGER NOT NULL,
  PRIMARY KEY (EXP_HIS_ID),
  FOREIGN KEY (UserID) REFERENCES UserMaster(UserID),
  FOREIGN KEY (EXP_ID) REFERENCES EXPENCE_TYPE(EXP_ID)
  
);

-- Passcode = "Welcome123#
INSERT INTO USERMASTER (USERNAME, USERKEY, USERSTATUS, USERTYPE) VALUES ('admin', '1663027827', 'Y', 'A');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('HOME RENT');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('POWER UNIT');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('INTERNET BILL');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('DIGITAL TV');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('TOYS');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('CIGRETTE/TEA');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('DRINKS/CIGRETTE');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('FOOD');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('DRESS / MATERIALS');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('MOBILE BILL');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('CAR MAINTANENCE');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('FUEL BILL');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('LAND TAX');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('DONATIONS');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('DEPOSITS');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('PARENTS EXPENCE');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('TOLL EXPENCES');
INSERT INTO EXPENCE_TYPE (EXP_NAME) VALUES ('TRAVEL EXPENCES');


commit;
Select * from usermaster;
delete from usermaster;

DROP TABLE EXPENCE_HISTORY;
DROP TABLE EXPENCE_TYPE;
DROP TABLE MasterUnitMessage;
DROP TABLE MasterUnitHistory;
DROP TABLE SensorHistory;
DROP TABLE SensorStatus;
DROP TABLE SensorUnit;
DROP TABLE SlaveUnit;
DROP TABLE MasterUnitController;
DROP TABLE UserMaster;
DROP TABLE FIN_FD_DETAILS;

DROP SEQUENCE EXP_HIS_DETAILS_SEQ;
DROP SEQUENCE EXP_DETAILS_SEQ;
DROP SEQUENCE FD_DETAILS_SEQ;
DROP SEQUENCE MASTER_MESSAGE_SEQ;
DROP SEQUENCE MASTER_HISTORY_SEQ;
DROP SEQUENCE SENSOR_STATUS_SEQ;
DROP SEQUENCE SENSOR_HISTORY_SEQ;
DROP SEQUENCE SENSOR_ID_SEQ;
DROP SEQUENCE SLAVE_ID_SEQ;
DROP SEQUENCE MASTER_ID_SEQ;
DROP SEQUENCE USER_ID_SEQ;